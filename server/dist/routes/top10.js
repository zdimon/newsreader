// Generated by CoffeeScript 1.9.3
(function() {
  var express, fs, getTop10FromFS, path, router, utils;

  express = require('express');

  router = express.Router();

  utils = require('../utils/utils');

  path = require('path');

  fs = require('fs');

  getTop10FromFS = function(offset) {
    var cont, date, dest;
    if (offset == null) {
      offset = 0;
    }
    date = utils.getNowDate(offset);
    try {
      dest = path.join(global.app_root, global.app_config.data_dir, "top10/" + date + ".json");
      return cont = JSON.parse(fs.readFileSync(dest, 'utf8'));
    } catch (_error) {
      offset = offset + 1;
      return getTop10FromFS(offset);
    }
  };

  router.get('/', function(req, res, next) {
    var e;
    try {
      return res.send(getTop10FromFS());
    } catch (_error) {
      e = _error;
      return res.send({
        status: 1,
        message: 'Top 10 is empty!',
        error: e
      });
    }
  });

  module.exports = router;

}).call(this);
